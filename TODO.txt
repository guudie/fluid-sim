[ ] reorganize code
[ ] implement better multithread exception handling using reduction